# Minecraft Stats

## By J_dg aka Jaden Unruh

### Web Interface

Home, or `<address>:8080/`, features a few screenshots from the server, topped by a navigation bar on top and a footer below that will persist across all pages. In the navigation bar, clicking the logo and server name in the top left will always take users back to this page, as will `Home`, the first of the navigational links. The rest of the navigational links will take users to each of the pages as described below.

- Players, or `<address>:8080/players`, features a list of all players that have logged onto the server, by IGN (name) and UUID. For each player, links are provided to view the player's stats, and their inventory. Following a link to stats will direct to `<address>:8080/stats/{name}`, which displays all of the stats recorded by Minecraft, sorted into `General Stats`, which includes all stats organized under `minecraft:custom`; `Item Stats`, which includes all stats organized under `minecraft:broken`, `minecraft:used`, `minecraft:dropped`, `minecraft:crafted`, `minecraft:mined`, and `minecraft:picked_up`; and `Mob Stats`, which includes stats organized under `minecraft:killed` and `minecraft:killed_by`. Following a link to player inventory will take users to `<address>:8080/inventory/{name}`, which displays the player's worn armor and offhand above a table showing their inventory, and another below that showing the contents of their ender chest. Hovering over any item will display a tooltip showing *some* item NBT data. Clicking a shulker box will open a larger tooltip with the shulker's contents that can be interacted with in the same way. The shulker can be closed by clicking it again, or by opening another shulker box. Note that not all items currently have textures, and any without a texture will show the texture of a barrier block item.

- Leaderboards, or `<address>:8080/leaderboards`, shows leaderboards of the top 5 players in a selection of statistics.

- Backups, or `<address>:8080/backups`, shows a list of recent backups with selected information about the backup and a link to the Google Drive download for it. Currently, there's a bug where data may repeat multiple times.

- World Map, or `<address>:8080/map` shows a zoomable, scrollable, tiled map of the world, generated by [uNmINeD](https://unmined.net/). This map is updated when a shell script on the server is run, which is, as of writing this, a manual process. I plan to automate this shortly. This script will also update player inventory information.

- GitHub links off the webpage, to this GitHub repository.

### API

The server front-end pages run off of an API at `<address>:8080/api`. The api has a few mappings, as described below.

- `<address>:8080/api/allStats` returns a large .json file with every player's stats.

- `<address>:8080/api/stats/{playerName}` returns a .json file with a single player's stats.

- `<address>:8080/api/players` returns a .json file mapping UUIDs to player names.

- `<address>:8080/api/backups` returns a .json file with backup data.

- `<address>:8080/api/map/{filePath}` returns files to do with rendering the map. These are served from a static folder generated by uNmINeD.

- `<address>:8080/api/textures/{itemName}` returns a .png image of an item texture. Any un-found items will return a barrier texture.

- `<address>:8080/api/inventories/{playerName}` returns a large .json file with the specified player's inventory data.

### The backend and program details

This tool uses a backend programmed in Java using Spring Boot and Maven, and all front-end pages are javascript compiled from Svelte. Svelte handles all routing except the API, Spring redirects every mapping except `/api/*` to `index.html` where mappings are handled by updating page content, rather than loading a new page.

On certain API calls (stats, players, backups), the backend will re-parse data from local files on the server to ensure up-to-date information. In a larger deployment, this would be scheduled to avoid extra overhead, but on such a small scale this way is acceptable.

API calls to players uses the [Mojang API]([Mojang API â€“ Minecraft Wiki](https://minecraft.wiki/w/Mojang_API)) to map player names to UUIDs.
